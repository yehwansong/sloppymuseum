<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="viewport" content = "width = device-width, initial-scale = 1.0, minimum-scale = 1, maximum-scale = 1, user-scalable = no" />
		<meta name="apple-mobile-web-app-title" content="onlyWebPro" />
		<style type="text/css">
			*{
			  margin: 0px;
			  padding:0;
			}
            body{
                width: 100vw;
                height: 100vh;
                /*background-image: url('img/door_4_1.JPG');*/

                background-size: cover;
                background-position: center;
                background: black
            }
            .elem{
                position: absolute;
                width: 100vw;
                height: 100%;
                left: 0;
                top: 0
            }
            .elem>div{
                width: 80vw;
            }
            canvas{
                position: fixed;
            }
            .door{
                width: 100vw;
                position: fixed;
                top: 0vw;
                left: 0vw;
                pointer-events: none;
                z-index: 10000;
                transform-origin: center 23%;
                transition: 0.5s
            }
            .door_zoomin{

                transform: scale(1.23);
            }
            .reset,.back{
    display: none;
position: fixed;
z-index: 10000000;
background: black;
padding: 4vw;
border-radius: 1vw;
right: 4vw;
bottom: 2vw;
border: 0.5vw solid white;
box-shadow: 0vw 0vw 1vw black;
color: white;
text-decoration: none;
top: auto;}
.back{
    bottom: 18vw;
}
.swipe{
position: fixed;
z-index: 10000000;
width: 35vw;
left: 32.5vw;
top: 75vw;
filter: invert();
animation: bounce 1s infinite;
    transform: translateY(0);
    display: none;
-webkit-animation: blink-animation 1s steps(5, start) infinite;
        }

        @keyframes blink-animation {
          to {
            visibility: hidden;
          }
        }
        @-webkit-keyframes blink-animation {
          to {
            visibility: hidden;
          }
        }
@media (min-aspect-ratio: 1/1) {
body{width: 55vh;
position: absolute;
left: calc(50vw - 27.5vh);}
.door{
    width: 55vh;
    position: absolute;
}
.reset, .back{
    display: inline;
    font-size: 2.5vw;
    font-family: sans-serif;
    padding: 2vw;
    border: 0.3vw solid white;
    font-size: 2.2vw;
    padding: 2vw;
    border: 0.25vw solid white;
height: 2vw;
}
.door_wrapper{
    width: 55vh ;
    position:absolute;
    overflow: hidden;
    height: 100vh;
}
.back{
    bottom: 10vw;
    right: 2vw;
}
.reset{
    bottom: 2vw;
    right: 2vw;
}
.swipe{display: none !important}
}
		</style>
	</head>
<body>
    <img class="door" src="img/door-12-white.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.11.0/matter.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
<script type="text/javascript">
var isMobile = false; //initiate as false
// device detection
if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent) 
    || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))) { 
    isMobile = true;
}
var Engine = Matter.Engine,
  Render = Matter.Render,
  World = Matter.World,
  Bodies = Matter.Bodies,
        Svg = Matter.Svg,
        MouseConstraint = Matter.MouseConstraint,
        Mouse = Matter.Mouse,
  Body = Matter.Body;

var engine = Engine.create();
 var w = window.innerWidth
 var h = window.innerHeight
if(w/h>1){
        w=0.55*h

$( ".door" ).wrap( "<div class='door_wrapper'></div>" );
}
var render = Render.create({
  element: document.body,
  engine: engine,
  options: {
    width: w,
    height: h,
            background: 'transparent',
    wireframes: false
  }
});

var topWall = Bodies.rectangle(400, 50, 720, 20, { isStatic: true});
var leftWall = Bodies.rectangle(50, 210, 20, 300, { isStatic: true});
var rightWall = Bodies.rectangle(750, 210, 20, 300, { isStatic: true});
var bottomWall = Bodies.rectangle(400, 350, 720, 20, { isStatic: true});

var ball = Bodies.rectangle(400, 350, 720, 20);

    var wall_1 = Bodies.rectangle(w/2, 0-25, w, 50, { isStatic: true,
    render: {
         fillStyle: 'black',
         strokeStyle: 'black',
         lineWidth: 0
    }  })
    var wall_2 = Bodies.rectangle(w+25, h/2, 50, h, { isStatic: true,
    render: {
         fillStyle: 'black',
         strokeStyle: 'black',
         lineWidth: 0
    }  })
    var wall_3 = Bodies.rectangle(0-25, h/2, 50, h, { isStatic: true,
    render: {
         fillStyle: 'black',
         strokeStyle: 'black',
         lineWidth: 0
    }  })
    var side_wall_1 = Bodies.rectangle(0, 0, w*0.6, w, { isStatic: true,
    render: {
         fillStyle: 'black',
         strokeStyle: 'black',
         lineWidth: 0
    } })
    var side_wall_2 = Bodies.rectangle(w, 0, w*0.6, w, { isStatic: true,
    render: {
         fillStyle: 'black',
         strokeStyle: 'black',
         lineWidth: 0
    } })
    World.add(engine.world, [
        wall_1, wall_2, wall_3,side_wall_1,side_wall_2
    ]);
    Matter.Body.setAngle(side_wall_1, Math.PI/4);
    Matter.Body.setAngle(side_wall_2, -1*Math.PI/4);
engine.world.gravity.y = -1;
World.add(engine.world, ball);

Engine.run(engine);

Render.run(render);

$(document).ready(function(){
    $('.door').addClass('door_zoomin')
    setTimeout(function(){
        $('.swipe').show()
        $('.reset').show()
        $('.back').show()
    },500)
    $('.elem>div').each(function(){
        console.log($(this).outerWidth())
        console.log($(this).outerHeight())
    }) 
            var c = document.getElementsByTagName('canvas')[0]
            c.addEventListener('touchstart', handleTouchStart, false);        
            // c.addEventListener('touchmove', handleTouchMove, false);      
            // c.addEventListener('touchend', handleTouchend, false);        
            // c.addEventListener('mousemove', handleTouchMove, false); 
            var swipe = true
            var xDown = null;                                                        
            var yDown = null;
            var counter = 0
            function getTouches(evt) {
              return evt.touches ||             // browser API
                     evt.originalEvent.touches; // jQuery
            }                                                     

            function handleTouchStart(evt) {
                $('.swipe').hide()
                counter ++ 
                if(counter > 29){
                    counter = 29
                }
                if(isMobile){
                                    if(counter%5 == 0 ){
                                        var rec = Bodies.rectangle(w*(0.4+Math.floor(Math.random()*2)*0.2), h, w*0.5, w*0.333,{
                                                    render: {
                                                        lineWidth: 0,
                                                        sprite: {
                                                            texture: 'door4_img/img_'+counter+'.jpg',
                                                            xScale: 0.4,
                                                            yScale: 0.4
                                                        }
                                                    }}
                                            )
                                    }else if(counter == 29){
                                        console.log('counter')
                                        var rec = Bodies.rectangle(w*(0.4+Math.floor(Math.random()*2)*0.2), h, w*0.5, w*0.333,{
                                                    render: {
                                                        lineWidth: 0,
                                                        sprite: {
                                                            texture: 'door4_img/img_'+counter+'.png',
                                                            xScale: 0.4,
                                                            yScale: 0.4
                                                        }
                                                    }}
                                            )
                                        counter = 1
                                    }else{
                                        var rec = Bodies.rectangle(w*(0.4+Math.floor(Math.random()*2)*0.2), h, w*0.8, unit*height_array[counter-1],{
                                                    render: {
                                                        lineWidth: 0,
                                                        sprite: {
                                                            texture: 'door4_img/img_'+counter+'.png',
                                                            xScale: 0.7,
                                                            yScale: 0.7
                                                        }
                                                    }}
                                            )
                                    }
                }

                World.add(engine.world, rec)
                var ran = 1
                if(counter%2 == 0){
                    ran = -1
                }
                Body.setAngularVelocity( rec, ran*Math.PI/180);                                
            };                              
            $('canvas').click(function(e){
                $('.swipe').hide()

                counter ++ 
                if(counter > 29){
                    counter = 29
                }
                if(!isMobile){
                                    if(counter%5 == 0 && counter<23){
                                        var rec = Bodies.rectangle(w*(0.4+Math.floor(Math.random()*2)*0.2), h, w*0.5, w*0.333,{
                                                    render: {
                                                        lineWidth: 0,
                                                        sprite: {
                                                            texture: 'door4_img/img_'+counter+'.jpg',
                                                            xScale: 0.5,
                                                            yScale: 0.5
                                                        }
                                                    }}
                                            )
                                    }else if(counter == 29){
                                        console.log('counter')
                                        var rec = Bodies.rectangle(w*(0.4+Math.floor(Math.random()*2)*0.2), h, w*0.5, w*0.333,{
                                                    render: {
                                                        lineWidth: 0,
                                                        sprite: {
                                                            texture: 'door4_img/img_'+counter+'.png',
                                                            xScale: 0.5,
                                                            yScale: 0.5
                                                        }
                                                    }}
                                            )
                                        counter = 1
                                    }else{
                                        var rec = Bodies.rectangle(w*(0.4+Math.floor(Math.random()*2)*0.2), h, w*0.8, unit*height_array[counter-1],{
                                                    render: {
                                                        lineWidth: 0,
                                                        sprite: {
                                                            texture: 'door4_img/img_'+counter+'.png',
                                                            xScale: 0.875,
                                                            yScale: 0.875
                                                        }
                                                    }}
                                            )
                                    }
                }

                World.add(engine.world, rec)
                var ran = 1
                if(counter%2 == 0){
                    ran = -1
                }
                Body.setAngularVelocity( rec, ran*Math.PI/180);
            })
            var height_array = [60, 45, 45, 45, 0, 60, 60, 75, 75, 0, 60, 45, 60, 60, 0, 45, 45, 60, 60, 0, 45, 45, 45, 60, 45, 45, 45, 45, 0]
            var unit = w*0.8/230
            $('.reset').click(function(){
                        Body.setPosition(wall_1, { x:100*w, y: -25});
                            Body.setPosition(side_wall_1, { x: 100*w, y:0})
                            Body.setPosition(side_wall_2, { x: 100*w, y:0})
                        swipe = false
                        setTimeout(function(){
                            Body.setPosition(wall_1, { x:w/2, y: -25});
                            Body.setPosition(side_wall_1, { x: 0, y:0})
                            Body.setPosition(side_wall_2, { x: w, y:0})
                            swipe = true
                        },3000)
            })
            $('.back').click(function(){
                window.location.href = "index.html";
            })
            function handleTouchend(){
                    down = false
            }
            function minTwoDigits(n) {
                return (n < 10 ? '0' : '') + n;
            }
            var mouse = Mouse.create(render.canvas),
                mouseConstraint = MouseConstraint.create(engine, {
                    mouse: mouse,
                    constraint: {
                        stiffness: 0.2,
                        render: {
                            visible: false
                        }
                    }
                });

            World.add(engine.world, mouseConstraint);
}) 
</script>
<a src="index.html" class="back">처음으로</a>
<div class="reset">더보기</div>
<img class="swipe" src="img/swipe.png">
</body>